<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="layout/basic">

<th:block layout:fragment="title">
    <title>팀 구성</title>
</th:block>

<th:block layout:fragment="add-css">
    <link rel="stylesheet" th:href="@{/css/teamBuilderStyles.css}">
</th:block>

<th:block layout:fragment="content">
    <!-- 제목 -->
    <div class="mt-4 mb-2 d-flex align-items-center">
        <i class="fas fa-futbol fa-2x me-1"></i>
        <h2 class="mb-0">팀 구성</h2>
    </div>
    <!--팀 구성 카드-->
    <div class="card mb-4 mt-4">
        <div class="card-header">
            <i class="fas fa-puzzle-piece me-1"></i>
            팀 구성(구성하고 싶은 팀을 선택 후 팀 섞기 버튼을 눌러주세요.)
        </div>
        <div class="card-body">
            <ol class="list-group">
                <div class="text-end mb-2">
                    <input type="radio" class="btn-check" id="twoTeamCheck" name="teamSetup" checked>
                    <label for="twoTeamCheck" class="btn btn-outline-secondary ms-5">2팀 구성</label>
                    <input type="radio" class="btn-check" id="threeTeamCheck" name="teamSetup">
                    <label for="threeTeamCheck" class="btn btn-outline-secondary ms-5">3팀 구성</label>
                    <input type="radio" class="btn-check" id="fourTeamCheck" name="teamSetup">
                    <label for="fourTeamCheck" class="btn btn-outline-secondary ms-5">4팀 구성</label>
                    <button type="button" class="btn btn-primary ms-5" id="assembleBtn"
                            onclick="assembleTeam(this);">팀 섞기</button>
                    <button type="button" class="btn btn-primary ms-5 d-none" id="reassembleBtn"
                            onclick="assembleTeam(this);">팀 다시 섞기</button>
                    <button type="button" class="btn btn-danger ms-5 d-none" id="deleteBtn"
                            onclick="assembleTeam(this);">팀 삭제</button>
                </div>
                <div class="mt-4 mb-2 d-flex align-items-center">
                    <div class="align-items-center centered-flex">
                        <strong class="text-center">참석 인원</strong>
                        <ul class="list-group no-markers">
                            <li th:each="attendee: ${attendees}" class="list-group text-center" th:text="${attendee.memberName}"></li>
                        </ul>
                    </div>
                    <div class="align-items-center centered-flex d-none" id="teamA">
                        <strong class="text-center">a팀</strong>
                        <ul class="list-group no-markers">
                            <li></li>
                        </ul>
                    </div>
                    <div class="align-items-center centered-flex d-none" id="teamB">
                        <strong class="text-center">b팀</strong>
                        <ul class="list-group no-markers">
                            <li></li>
                        </ul>
                    </div>
                    <div class="align-items-center centered-flex d-none" id="teamC">
                        <strong class="text-center">c팀</strong>
                        <ul class="list-group no-markers">
                            <li></li>
                        </ul>
                    </div>
                    <div class="align-items-center centered-flex d-none" id="teamD">
                        <strong class="text-center">d팀</strong>
                        <ul class="list-group no-markers">
                            <li></li>
                        </ul>
                    </div>
                </div>
            </ol>
        </div>
    </div>



</th:block>

<th:block layout:fragment="script">
    <script th:inline="javascript">
        let userId = /*[[${session.userId}]]*/ null; // 세션의 userId 값을 가져옴

        // 팀 구성 관련 버튼 클릭 시
        function assembleTeam(e){

            // 버튼 변수 선언
            const assembleBtn = document.querySelector('#assembleBtn');
            const reassembleBtn = document.querySelector('#reassembleBtn');
            const deleteBtn = document.querySelector('#deleteBtn');
            const twoTeamCheck = document.querySelector('#twoTeamCheck');
            const threeTeamCheck = document.querySelector('#threeTeamCheck');
            const fourTeamCheck = document.querySelector('#fourTeamCheck');
            const teamRadioArray = [twoTeamCheck, threeTeamCheck, fourTeamCheck];

            // div 요소 변수 선언
            const teamA = document.querySelector('#teamA');
            const teamB = document.querySelector('#teamB');
            const teamC = document.querySelector('#teamC');
            const teamD = document.querySelector('#teamD');
            const teamDivArray = [teamA, teamB, teamC, teamD];

            // 몇 팀을 구성하는지에 따라 div 보이게 하기
            let teamArray = [];
            if(teamRadioArray[0].checked){ // 2팀 구성 클릭
                teamArray.push(teamDivArray[0]);
                teamArray.push(teamDivArray[1]);
            }else if(teamRadioArray[1].checked){ // 3팀 구성 클릭
                teamArray.push(teamDivArray[0]);
                teamArray.push(teamDivArray[1]);
                teamArray.push(teamDivArray[2]);
            }else if(teamRadioArray[2].checked){ // 4팀 구성 클릭
                teamArray.push(teamDivArray[0]);
                teamArray.push(teamDivArray[1]);
                teamArray.push(teamDivArray[2]);
                teamArray.push(teamDivArray[3]);
            }

            // 팀 div 안보이게 초기화
            for(let i = 0; i < teamDivArray.length; i++){
                if(!teamDivArray[i].classList.contains('d-none')){ // d-none 클래스가 없을 때만 추가
                    teamDivArray[i].classList.add('d-none');
                }
            }

            // 버튼마다 다른 동작
            if(assembleBtn == e || reassembleBtn == e){ // 팀 구성 및 팀 다시 섞기 버튼 클릭 시
                e.classList.add('d-none');
                reassembleBtn.classList.remove('d-none');
                deleteBtn.classList.remove('d-none');
                for(let i = 0; i < teamArray.length; i++){
                    teamArray[i].classList.remove('d-none');
                }
            }else if(deleteBtn == e){ // 팀 삭제 버튼 클릭 시
                e.classList.add('d-none');
                reassembleBtn.classList.add('d-none');
                assembleBtn.classList.remove('d-none');
                for(let i = 0; i < teamArray.length; i++){
                    teamArray[i].classList.add('d-none');
                }
            }
        }

    </script>
</th:block>

</html>
